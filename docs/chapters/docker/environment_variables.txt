.. index:: Docker environment variables
.. _docker_environment_variables:


=====================
Environment Variables
=====================

The common set of settings can also be modified via environment variables when
using the Docker image. In addition to the common set of settings, some Docker
image specific environment variables are available.


- ``MAYAN_APT_INSTALLS``

  Specifies a list of Ubuntu .deb packages to be installed via APT when the
  container is first created. The installed packages are not lost when the image
  is stopped. Example: To install the Tesseract OCR language packs for German
  and Spanish add the following in your ``docker start`` command line:

  .. code-block:: console

      -e MAYAN_APT_INSTALLS="tesseract-ocr-deu tesseract-ocr-spa"


- ``MAYAN_DOCKER_WAIT``

  Optional. Make the Docker container wait for a host and port to become
  available. Multiple hosts and port combinations are supported.

  Example:

  .. code-block:: console

      -e MAYAN_DOCKER_WAIT="db:5432 redis:6379"

- ``MAYAN_SETTINGS_MODULE``

  Optional. Allows loading an alternate settings file.

- ``MAYAN_GUNICORN_TIMEOUT``

  Optional. Changes the amount of time the frontend worker will wait for a
  request to finish before raising a timeout error. The default is 120
  seconds.

- ``MAYAN_GUNICORN_WORKER_CLASS``

  Optional. Changes the type of worker used. Defaults to ``sync``.
  Custom worker classes can be used by passing a Python path to the subclass.

- ``MAYAN_GUNICORN_WORKERS``

  Optional. This environment variable controls the number of frontend workers
  that will be executed. If not specified the default is 2. For heavier loads,
  user a higher number. A formula recommended for this setting is the number
  of CPU cores + 1.

- ``MAYAN_PIP_INSTALLS``

  Specifies a list of Python packages to be installed via ``pip``. Packages will
  be downloaded from the Python Package Index (https://pypi.python.org) by
  default.

- ``MAYAN_SKIP_CHOWN_ON_STARTUP``

  Optional. Setting this environment variable to ``true``, will make the
  entrypoint script, skip the initial chwon command on the media folder
  at ``/var/lib/mayan``.

- ``MAYAN_WORKER_A_CONCURRENCY``

  Optional. Changes the concurrency (number of child processes) of the Celery
  worker consuming the queues in the A category (low latency,
  very short duration, interactive tasks). Default is 1. Use 0 to disable
  hard coded concurrency and allow the Celery worker to launch its default
  number of child processes (equal to the number of CPUs detected).

- ``MAYAN_WORKER_B_CONCURRENCY``

  Optional. Changes the concurrency (number of child processes) of the Celery
  worker consuming the queues in the B category (small latency,
  small duration tasks). Default is 1. Use 0 to disable hard coded
  concurrency and allow the Celery worker to launch its default number
  of child processes (equal to the number of CPUs detected).

- ``MAYAN_WORKER_C_CONCURRENCY``

  Optional. Changes the concurrency (number of child processes) of the Celery
  worker consuming the queues in the C category (medium latency,
  medium duration tasks). Default is 1. Use 0 to disable hard coded
  concurrency and allow the Celery worker to launch its default number
  of child processes (equal to the number of CPUs detected).

- ``MAYAN_WORKER_D_CONCURRENCY``

  Optional. Changes the concurrency (number of child processes) of the Celery
  worker consuming the queues in the C category (high latency,
  long duration tasks). Default is 1. Use 0 to disable hard coded
  concurrency and allow the Celery worker to launch its default number
  of child processes (equal to the number of CPUs detected).

- ``MAYAN_USER_UID``

  Optional. Changes the UID of the ``mayan`` user internal to the Docker
  container. Defaults to 1000.

- ``MAYAN_USER_GID``

  Optional. Changes the GID of the ``mayan`` user internal to the Docker
  container. Defaults to 1000.
